<!--  https://poe.com/lessonContainer1 -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course Container Template</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        'primary-light': '#7B7AE8',
                        'primary-dark': '#4A49C2'
                    }
                }
            }
        }
    </script>
    <style>
        .section-transition {
            transition: all 0.3s ease-in-out;
        }
        .section-collapsed {
            opacity: 0.6;
            transform: scale(0.98);
        }
        .section-expanded {
            opacity: 1;
            transform: scale(1);
        }
    </style>
    <base href="./" />
</head>
<body class="bg-white dark:bg-gray-900">
    <script>
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
    </script>

    <div class="min-h-screen">
        <!-- Header -->
        <div class="bg-gradient-to-r from-primary to-primary-light text-white p-6">
            <div class="max-w-4xl mx-auto">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-3xl font-bold mb-2">Course Container Template</h1>
                        <p class="text-primary-light">Ready for your course content</p>
                    </div>
                    <a href="#" 
                       class="bg-white bg-opacity-20 hover:bg-opacity-30 px-4 py-2 rounded-lg transition-colors flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                        </svg>
                        Back to Course
                    </a>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="max-w-4xl mx-auto p-6">
            <!-- Course Overview Section -->
            <div class="mb-8">
                <div class="bg-gradient-to-br from-primary/5 to-primary-light/5 dark:from-primary/10 dark:to-primary-light/10 rounded-xl p-8 border border-primary/20">
                    <div class="text-center mb-8">
                        <div class="w-16 h-16 bg-gradient-to-r from-primary to-primary-light rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-white text-2xl">ðŸ“š</span>
                        </div>
                        <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-2">Course Name Here</h2>
                        <p class="text-lg text-gray-600 dark:text-gray-400 mb-4">Course Code: XXXX 0000</p>
                    </div>

                    <div class="grid md:grid-cols-2 gap-8">
                        <!-- Course Information -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm">
                            <h3 class="text-xl font-bold text-primary mb-4">ðŸ“‹ Course Information</h3>
                            <div class="space-y-3 text-gray-700 dark:text-gray-300">
                                <div><strong>Week:</strong> Week X - Topic Title</div>
                                <div><strong>Duration:</strong> X hours</div>
                                <div><strong>Format:</strong> Interactive Learning</div>
                                <div><strong>Prerequisites:</strong> None / List requirements</div>
                            </div>
                        </div>

                        <!-- Learning Objectives -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm">
                            <h3 class="text-xl font-bold text-primary mb-4">ðŸŽ¯ Learning Objectives</h3>
                            <ul class="space-y-2 text-sm text-gray-700 dark:text-gray-300">
                                <li>â€¢ Objective placeholder 1</li>
                                <li>â€¢ Objective placeholder 2</li>
                                <li>â€¢ Objective placeholder 3</li>
                                <li>â€¢ Objective placeholder 4</li>
                                <li>â€¢ Objective placeholder 5</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Content Overview -->
                    <div class="mt-8 bg-white dark:bg-gray-800 rounded-lg p-6">
                        <h3 class="text-lg font-bold text-gray-900 dark:text-white mb-4">ðŸ“– Content Overview</h3>
                        <p class="text-gray-700 dark:text-gray-300 mb-4">
                            Replace this with a brief description of what students will learn in this module. 
                            Explain the key concepts, skills, and knowledge they will gain.
                        </p>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="text-center p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                                <div class="text-2xl mb-2">ðŸ“š</div>
                                <div class="text-sm font-medium text-blue-800 dark:text-blue-200">Section 1</div>
                            </div>
                            <div class="text-center p-3 bg-green-50 dark:bg-green-900/20 rounded-lg">
                                <div class="text-2xl mb-2">ðŸŽ®</div>
                                <div class="text-sm font-medium text-green-800 dark:text-green-200">Section 2</div>
                            </div>
                            <div class="text-center p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg">
                                <div class="text-2xl mb-2">ðŸ’­</div>
                                <div class="text-sm font-medium text-purple-800 dark:text-purple-200">Section 3</div>
                            </div>
                            <div class="text-center p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg">
                                <div class="text-2xl mb-2">ðŸŽ¯</div>
                                <div class="text-sm font-medium text-orange-800 dark:text-orange-200">Section 4</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modified Navigation Section -->
            <div class="mt-8 bg-white dark:bg-gray-800 rounded-lg p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-lg font-bold text-gray-900 dark:text-white">ðŸ§­ Learning Activities</h3>
                    
                    <!-- Report Generation Button -->
                    <button onclick="generateReport()" 
                            class="bg-primary hover:bg-primary-dark text-white px-4 py-2 rounded-lg flex items-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                                  d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                        </svg>
                        Generate Report
                    </button>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <button onclick="loadContent('interactiveLecture.html')" 
                            data-section="lecture"
                            class="section-btn section-transition bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 p-6 rounded-lg text-center transition-all">
                        <div class="text-2xl mb-2">ðŸ“š</div>
                        <div class="text-lg font-medium text-blue-800 dark:text-blue-200">Interactive Lecture</div>
                        <div class="text-sm text-blue-600 dark:text-blue-300 mt-2">
                            <span class="completion-status">â­• Not Started</span>
                        </div>
                    </button>

                    <button onclick="loadContent('PracticeDiscussion.html')" 
                            data-section="practice"
                            class="section-btn section-transition bg-green-50 dark:bg-green-900/20 hover:bg-green-100 dark:hover:bg-green-900/30 p-6 rounded-lg text-center transition-all">
                        <div class="text-2xl mb-2">ðŸ’¬</div>
                        <div class="text-lg font-medium text-green-800 dark:text-green-200">Practice & Discussion</div>
                        <div class="text-sm text-green-600 dark:text-green-300 mt-2">
                            <span class="completion-status">â­• Not Started</span>
                        </div>
                    </button>

                    <button onclick="loadContent('ReflectAssess.html')" 
                            data-section="reflect"
                            class="section-btn section-transition bg-purple-50 dark:bg-purple-900/20 hover:bg-purple-100 dark:hover:bg-purple-900/30 p-6 rounded-lg text-center transition-all">
                        <div class="text-2xl mb-2">ðŸŽ¯</div>
                        <div class="text-lg font-medium text-purple-800 dark:text-purple-200">Reflect & Assess</div>
                        <div class="text-sm text-purple-600 dark:text-purple-300 mt-2">
                            <span class="completion-status">â­• Not Started</span>
                        </div>
                    </button>
                </div>
            </div>

            <!-- Content Display Area -->
            <div class="mt-8">
                <div id="contentArea" class="bg-white dark:bg-gray-800 rounded-lg p-6">
                    <!-- Content will be loaded here -->
                </div>
            </div>

            <!-- Progress Tracking -->
            <div id="progressTracker" class="mt-8 bg-white dark:bg-gray-800 rounded-lg p-6 hidden">
                <h3 class="text-lg font-bold text-gray-900 dark:text-white mb-4">ðŸ“Š Progress Overview</h3>
                <div class="space-y-4" id="progressDetails">
                    <!-- Progress details will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Indicator -->
    <div id="loadingIndicator" class="fixed top-0 left-0 w-full h-1 bg-primary transform scale-x-0 transition-transform duration-300"></div>

    <script>
        // State management
        const learningState = {
            lecture: {
                completed: false,
                responses: {},
                timeSpent: 0,
                lastAccessed: null
            },
            practice: {
                completed: false,
                responses: {},
                timeSpent: 0,
                lastAccessed: null
            },
            reflect: {
                completed: false,
                responses: {},
                timeSpent: 0,
                lastAccessed: null
            }
        };

        // Timer for tracking time spent
        let activeTimer = null;
        let startTime = null;

        function startTimer(section) {
            if (activeTimer) clearInterval(activeTimer);
            startTime = Date.now();
            activeTimer = setInterval(() => {
                learningState[section].timeSpent += 1;
            }, 1000);
        }

        function stopTimer() {
            if (activeTimer) {
                clearInterval(activeTimer);
                activeTimer = null;
            }
        }

        // Content loading function
        async function loadContent(url) {
            toggleLoading(true);
            const section = url.split('.')[0].toLowerCase();
            
            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error('Content load failed');
                const content = await response.text();
                
                document.getElementById('contentArea').innerHTML = content;
                
                // Update section state
                learningState[section].lastAccessed = new Date().toISOString();
                startTimer(section);
                
                // Update UI
                updateSectionStatus(section);
                
            } catch (error) {
                console.error('Error loading content:', error);
                document.getElementById('contentArea').innerHTML = `
                    <div class="text-center text-red-600 dark:text-red-400 p-4">
                        <p>Error loading content. Please try again.</p>
                    </div>
                `;
            } finally {
                toggleLoading(false);
            }
        }

        // Report generation
        function generateReport() {
            const report = {
                timestamp: new Date().toISOString(),
                sections: {
                    lecture: formatSectionReport('lecture'),
                    practice: formatSectionReport('practice'),
                    reflect: formatSectionReport('reflect')
                },
                totalTimeSpent: calculateTotalTime(),
                overallProgress: calculateOverallProgress()
            };

            // Create and download report
            const reportBlob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
            const reportUrl = URL.createObjectURL(reportBlob);
            const downloadLink = document.createElement('a');
            downloadLink.href = reportUrl;
            downloadLink.download = `learning-report-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
            URL.revokeObjectURL(reportUrl);

            // Display report summary
            displayReportSummary(report);
        }

        function formatSectionReport(section) {
            return {
                completed: learningState[section].completed,
                timeSpent: formatTime(learningState[section].timeSpent),
                lastAccessed: learningState[section].lastAccessed,
                responses: learningState[section].responses
            };
        }

        function calculateTotalTime() {
            return Object.values(learningState).reduce((total, section) => total + section.timeSpent, 0);
        }

        function calculateOverallProgress() {
            const completedSections = Object.values(learningState).filter(section => section.completed).length;
            return (completedSections / 3) * 100;
        }

        function formatTime(seconds) {
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const remainingSeconds = seconds % 60;
            return `${hours}h ${minutes}m ${remainingSeconds}s`;
        }

        function displayReportSummary(report) {
            const progressTracker = document.getElementById('progressTracker');
            const progressDetails = document.getElementById('progressDetails');
            
            progressDetails.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                        <h4 class="font-semibold mb-2">Overall Progress</h4>
                        <div class="text-2xl font-bold text-primary">${report.overallProgress.toFixed(1)}%</div>
                    </div>
                    <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                        <h4 class="font-semibold mb-2">Total Time Spent</h4>
                        <div class="text-2xl font-bold text-primary">${formatTime(calculateTotalTime())}</div>
                    </div>
                </div>
            `;
            
            progressTracker.classList.remove('hidden');
        }

        // Helper functions
        function toggleLoading(show) {
            const loader = document.getElementById('loadingIndicator');
            loader.style.transform = show ? 'scaleX(1)' : 'scaleX(0)';
        }

        function updateSectionStatus(section) {
            const button = document.querySelector(`[data-section="${section}"]`);
            const statusSpan = button.querySelector('.completion-status');
            
            if (learningState[section].completed) {
                statusSpan.textContent = 'âœ… Completed';
                button.classList.add('ring-2', 'ring-primary');
            } else if (learningState[section].lastAccessed) {
                statusSpan.textContent = 'ðŸ”„ In Progress';
                button.classList.add('ring-2', 'ring-primary');
            }
        }

        // Event listener for saving responses
        window.addEventListener('message', function(event) {
            if (event.data.type === 'saveResponse') {
                const { section, response } = event.data;
                learningState[section].responses = {
                    ...learningState[section].responses,
                    ...response
                };
                if (response.completed) {
                    learningState[section].completed = true;
                    updateSectionStatus(section);
                }
            }
        });
    </script>
</body>
</html>

