<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HKBU Basic Chat Assistant</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/5.1.1/marked.min.js"></script>
    <!-- CSS Files -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/chat.css">
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>ü§ñ Chatbot Configuration</h2>
            </div>
            
            <div class="sidebar-content">
                <!-- API Configuration Section -->
                <div class="api-section">
                    <div class="api-header" onclick="toggleSection('api')">
                        <h3>üîë API Configuration</h3>
                        <span class="toggle-icon" id="api-toggle">‚ñº</span>
                    </div>
                    <div class="api-content" id="api-content">
                        <div class="input-group">
                            <label for="api-key">API Key:</label>
                            <input type="password" id="api-key" placeholder="Enter your API key">
                        </div>
                        
                        <div class="input-group">
                            <label for="model-select">Model:</label>
                            <select id="model-select">
                                <option value="gpt-4.1-mini">GPT-4.1 Mini</option>
                                <option value="gpt-4.1">GPT-4.1</option>
                                <option value="claude-3.5-sonnet">Claude 3.5 Sonnet</option>
                            </select>
                        </div>
                        
                        <div class="api-buttons">
                            <button onclick="testConnection()" class="btn btn-secondary">Test Connection</button>
                            <button id="connect-btn" onclick="connectAPI()" class="btn btn-primary" disabled>Connect</button>
                            <button onclick="clearAPI()" class="btn btn-danger">Clear API</button>
                        </div>
                        
                        <div id="connection-status" class="connection-status" style="display: none;"></div>
                    </div>
                </div>

                <!-- System Prompt Section -->
                <div class="prompt-section">
                    <div class="prompt-header" onclick="togglePrompt('system')">
                        <h3>‚öôÔ∏è System Instructions</h3>
                        <span class="toggle-icon">‚ñº</span>
                    </div>
                    <div class="prompt-content" id="system-content">
                        <div class="prompt-display" id="system-display">Loading system instructions...</div>
                        <div class="prompt-actions">
                            <button class="btn btn-primary" onclick="handleSystemPromptEdit()">‚úèÔ∏è Edit System</button>
                            <button class="btn btn-secondary" onclick="resetPrompt('system')">‚Ü∫ Reset</button>
                            <button class="btn btn-info" onclick="startNewSession()">üîÑ New Session</button>
                        </div>
                        <div class="prompt-hint">
                            <small>üí° Example roles:</small><br>
                            <span class="role-tag" onclick="handleRoleTagClick('Math Tutor')">Math Tutor</span>
                            <span class="role-tag" onclick="handleRoleTagClick('Writing Coach')">Writing Coach</span>
                            <span class="role-tag" onclick="handleRoleTagClick('Research Assistant')">Research Assistant</span>
                            <span class="role-tag" onclick="handleRoleTagClick('Language Partner')">Language Partner</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="sidebar-footer">
                <strong>Created by:</strong><br>
                Dr. Simon Wang<br>
                Innovation Officer, Language Centre<br>
                Hong Kong Baptist University<br>
                <a href="mailto:simonwang@hkbu.edu.hk">simonwang@hkbu.edu.hk</a>
            </div>
        </div>

        <!-- Chat Area -->
        <div class="chat-area">
            <div class="chat-header">
                <h1>HKBU Learning Assistant</h1>
                <button class="new-session-btn" onclick="startNewSession()">üîÑ New Session</button>
            </div>

            <div class="chat-messages" id="chat-messages">
                <div class="message assistant">
                    <div class="message-content">
                        üîë Please configure your API key first to start chatting!<br><br>
                        Follow the instructions in the sidebar to get your HKBU GenAI API key and test the connection.
                    </div>
                </div>
            </div>

            <div class="chat-input-container">
                <div class="chat-input-wrapper">
                    <textarea 
                        class="chat-input" 
                        id="message-input" 
                        placeholder="Connect your API key first to start chatting..."
                        rows="1"
                        disabled
                    ></textarea>
                    <div class="input-buttons">
                        <button class="send-btn" id="send-btn" onclick="sendMessage()" disabled>‚û§</button>
                        <button class="done-btn" id="done-btn" onclick="generateReport()" disabled>üìÑ Export Chat</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Modules -->
    <script src="js/core.js"></script>
    <script src="js/prompts.js"></script>
    <script src="js/reports.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
